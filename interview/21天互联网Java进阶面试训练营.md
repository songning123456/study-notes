#### 第二季

* 你们公司用的Dubbo?那你再额外说说Spring Cloud的核...

* 基于Dubbo和Spring Cloud分别搭建一个电商系统来快速体...

* 你们的系统使用了哪种服务框架?为什么要这样技术...

* 看过Dubbo源码吗?说说Dubbo的底层架构原理?...

* 咱们来聊点深入的,说说Dubbo底层的网络通信机制原...

* Dubbo框架从架构设计角度,是怎么保证极高的可扩展性...

* 自己独立画出Dubbo的底层架构原理图

* 如果让你设计一个RPC框架,网络通信 代理机制 负载...

* 平时除了使用外,有研究过Spring Cloud的底层架构原理...

* 从底层实现原理的角度,对比一下Dubbo和Spring Cloud的...

* 自己独立画出Spring Cloud的架构原理图,RPC框架...

* 你们的服务注册中心进行过选型调研吗?对比一...

* 画图阐述一下你们的服务注册中心部署架构,生产环境下怎...

* 你们系统遇到过服务发现过慢的问题吗?怎么优化和解决...

* 说一下自己公司的服务注册中心怎么技术选型的?生...

* 你们对网关的技术选型是怎么考虑的?能对比一下各种网关...

* 说说生产环境下,你们是怎么实现网关对服务的动态路由...

* 如果网关需要抗每秒10万的高并发访问,你应该怎么对网关...

* 你们公司的网关是怎么技术选型的,假设有高并发场...

* 如果需要部署上万服务实例,现有的服务注册中心能否抗...

* 你们是如何基于网关实现灰度发布的?说说你们的灰度发布...

* 说说你们一个服务从开发到上线, 服务注册 网关路由 服...

* 看看你们公司的服务注册中心能否支撑上万服务实例...

* 画一下你们系统架构的整体架构图?说说各个服务在生产环境怎...

* 你们系统每天有多大的访问量?每个服务高峰QPS多少?压...

* 如果系统访问量比现在增加10倍,你们考虑过系统的扩容...

* 独立画出自己系统的生产环境部署架构图,梳理系统和服务...

* 你们生产环境的服务是怎么配置超时和重试参数的?为什...

* 如果出现服务请求重试,会不会出现类似重复下单的问题?

* 对于核心接口的防重幂等性,你们是怎么设计的?怎么防...

* 看看自己系统的接口有没有设计幂等性方案?如...

* 画一下你们电商系统的核心交易链路图,说说分布式架构下...

* 针对电商核心交易链路,你们是怎么设计分布式事务技术方...

* 对于TCC事务,最终一致性事务的技术选型,你们是怎么做...

* 你们公司的核心链路是否有事务问题?分布式事务方...

* 在搭建的电商系统里,落地开发对交易链路的TCC分布式...

* 你能说说一个TCC分布式事务框架的核心架构原理吗?

* 现有的TCC事务方案的性能瓶颈在哪里?能支撑高并发交易...

* 如果对自己的系统核心链路落地TCC事物,应该如何...

* 你了解RocketMQ对分布式事务支持的底层实现原理吗?...

* 在搭建好的电商系统里,如何基于RocketMQ最终一致性事...

* 如果公司没有RocketMQ中间件,那你们如何实现最终一致性...

* 如果对自己的系统落地最终一致性事务,如何落地实...

* 你们生产系统中有哪个业务场景是需要使用分布式锁的?为什...

* 你们是用哪个开源框架实现的Redis分布式锁?说说其核...

* 如果Redis是集群部署的,那么集群故障时分布式锁还有效...

* 自己梳理出来Redis分布式锁的生产环境问题解决方案！

* 如果要实现Zookeeper分布式锁,一般用哪个开源框架?核...

* 对于ZooKeeper的羊群效应,分布式锁实现应该如何优...

* 如果遇到Zookeeper脑裂问题,分布式锁应该如何保证健壮...

* 自己梳理出来ZooKeeper分布式锁的生产问题...

* 在搭建好的电商系统中,落地开发分布式保证库存数据准...

* 你们的分布式锁做过高并发优化吗?能扛下每秒上万并发...

* 淘宝和京东的库存是怎么实现的?能不能不用分布式锁实现...

* 自己系统的分布式锁在高并发场景下应该如何优化?


#### 第三季

* 为什么在Java面试中一定会深入考察HashMap?

```
*** https://blog.csdn.net/qq116165600/article/details/103361385

  HashMap作为一个键值对(key-value)的常见集合，在整个java的使用过程中都起着举足轻重的作用。
比如从DB中取值、数据的加工、数据回传给前端、数据转换为json等都可能使用到HashMap；且HashMap
作为一个可以允许空键值对的集合，也能实现自动的扩容，扩容的参数值为0.75，达到后自动扩容一倍，
这样给一些处理未知数据量大小的数据来说，是很方便的。虽然HashMap是线程不安全的，主要体现在
1.7和1.8上。1.7的hashMap在扩容的时候回形成循环链，导致死循环而报错，或者数据的丢失情况，
在1.8上，虽然对这方面做了改进，但是仍然是线程不安全的，主要是体现在，若多线程操作数据，
如线程A  B同时进行数据的put操作，在put操作前，会进行key的hash碰撞，但是线程A  B有可能同时
碰撞且碰撞的值相同，那么就会发生线程A先插入到了碰撞的地方值，然后B也随后插入到同样的地方，导
致线程B会覆盖线程A所插入的值，导致数据丢失。所以，在面试的时候，都很喜欢问HashMap。
```

* 你知道HashMap底层的数据结构是什么吗?

```
  (数组 + 链表)
  HashMap是一个用于存储Key-Value键值对的集合，每一个键值对也叫Entry，这些个键值对（Entry）
分散存储在一个数组之中，这个数组就是hashMap的主干，HashMap数组每一个元素的初始值都是null
```

* JDK1.8中对hash算法和寻址算法是如何优化的?

```
*** https://www.cnblogs.com/Edward-Wang/p/12362922.html

static final int hash(Object key) {
        int h;
        return (key == null) ? 0 : (h = key.hashCode()) ^ (h >>> 16);
}
    h = key.hashCode() 表示 h 是 key 对象的 hashCode 返回值；
    h >>> 16 是 h 右移 16 位，因为 int 是 4 字节，32 位，所以右移 16 位后变成：左边 16 个 0 + 
右边原 h 的高 16 位；最后把这两个进行异或返回。
    异或：二进制位运算。如果一样返回 0，不一样则返回 1
    hash算法的优化：对每个hash值，在它的低16位中，让高低16位进行异或，让它的低16位同时保持了高低16
位的特征，尽量避免一些hash值后续出现冲突，大家可能会进入数组的同一位置。
    寻址算法的优化：用与运算替代取模，提升性能。（由于计算机对比取模，与运算会更快）
```

* 你知道HashMap是如何解决hash碰撞问题的吗?

```
  利用“拉链法”处理HashCode的碰撞问题；当我们将键值对传递给put方法时，他调用键对象的hashCode()方法来
计算hashCode，然后找到bucket（哈希桶）位置来存储对象；当用get方法获取对象时，通过键对象的equals()方
法找到正确的键值对，然后返回值对象。HashMap使用链表来解决碰撞问题，当碰撞发生了，对象将会存储在链表的
下一个节点中。hashMap在每个链表节点存储键值对对象。当两个不同的键却有相同的hashCode时，他们会存储在同
一个bucket位置的链表中。键对象的equals()来找到键值对。
```

* 说说HashMap是如何进行扩容的可以吗?

```
  jdk1.7扩容是重新计算hash；jdk1.8是要看看原来的hash值新增的那个bit是1还是0好了，如果是0则索引没变，如果
是1则索引变成"原索引+oldCap".这是jdk1.8的亮点，设计的确实非常的巧妙，即省去了重新计算hash值得时间，又均匀
的把之前的冲突的节点分散到新的数组bucket上jdk1.7在rehash的时候，旧链表迁移到新链表的时候，如果在新表的数组
索引位置相同，则链表元素会倒置，但是jdk1.8不会倒置
```

* HashMap默认的初始长度是多少？为什么这么规定？[补充]

```
 HaspMap的默认初始长度是16，并且每次扩展长度或者手动初始化时，长度必须是2的次幂。之所以是16，是为了服务于从Key
值映射到index的hash算法。前面说到了，从Key值映射到数组中所对应的位置需要用到一个hash函数：index = hash("Java");
那么为了实现一个尽量分布均匀的hash函数，利用的是Key值的HashCode来做某种运算。因此问题来了，如何进行计算，才能让这
个hash函数尽量分布均匀呢？一种简单的方法是将Key值的HashCode值与HashMap的长度进行取模运算，即 index = HashCode(Key)
% hashMap.length，但是，但是！这种取模方式运算固然简单，然而它的效率是很低的， 而且，如果使用了取模%， 那么HashMap在
容量变为2倍时， 需要再次rehash确定每个链表元素的位置，浪费了性能。因此为了实现高效的hash函数算法，HashMap的发明者采用
了位运算的方式。那么如何进行位运算呢？可以按照下面的公式：index = HashCode(Key) & (hashMap.length - 1);
```

* 高并发情况下，HashMap会出现死锁吗？[补充]

```
*** https://coolshell.cn/articles/9606.html

由于HashMap的容量是有限的，如果HashMap中的数组的容量很小，假如只有2个，那么如果要放进10个keys的话，碰撞就会非常频繁，
此时一个O(1)的查找算法，就变成了链表遍历，性能变成了O(n)，这是Hash表的缺陷。为了解决这个问题,HashMap设计了一个阈值，
其值为容量的0.75，当HashMap所用容量超过了阈值后，就会自动扩充其容量。在多线程的情况下，当重新调整HashMap大小的时候，
就会存在条件竞争，因为如果两个线程都发现HashMap需要重新调整大小了，它们会同时试着调整大小。在调整大小的过程中，存储在
链表中的元素的次序会反过来，因为移动到新的bucket位置的时候，HashMap并不会将元素放在链表的尾部，而是放在头部，这是为了
避免尾部遍历。如果条件竞争发生了，那么就会产生死循环了。
```

* BAT面试官为什么都喜欢问并发编程的问题?

* 说说synchronized的关键字的底层原理是什么?

* 深入讲解synchronized,CAS的说明[深入到硬件级别]

* 能聊聊你对CAS的理解以及其底层原理可以吗?

```
*** https://blog.csdn.net/hanjungua8144/article/details/87881987

  CAS会操作3个数字，当前内存中的值，旧的预期值，新的修改值，只有当旧的预期值跟内存中的值一样的时候，才会将内存中的值修改为新的修
改值。举个例子吧，比如int a = 3，这是内存中的当前值，然后你CAS（3, 5），第一个是旧的预期值，如果3和a是一样的，那么就将a修改为5。
其实吧，这里比较关键的一点就是cpu的compareAndSwap操作的原理是啥，以CPU（Intel X86）来举个例子。这块底层指令，会根据当前处理器
类型，来决定要不要对一个cmpxchg指令加lock前缀，如果是单处理器，就不要加，因为自动保证顺序；但是如果是多处理器，就加个lock。intel
对lock的定义，就是说加了lock之后，就会自动锁掉一块内存区域，然后同一时间只有一个处理器可以读写这块内存区域，其他处理器就不行了。

    CAS其实有3个缺点:

    * ABA问题：如果某个值一开始是A，后来变成了B，然后又变成了A，你本来期望的是值如果是第一个A才会设置新值，结果第二个A一比较也ok，
也设置了新值，跟期望是不符合的。所以atomic包里有AtomicStampedReference类，就是会比较两个值的引用是否一致，如果一致，才会设置新值
假设一开始变量i = 1，你先获取这个i的值是1，然后累加了1，变成了2。但是在此期间，别的线程将i -> 1 -> 2 -> 3 -> 1这个期间，这个值是
被人改过的，只不过最后将这个值改成了跟你最早看到的值一样的值。结果你后来去compareAndSet的时候，会发现这个i还是1，就将它设置成了2，
就设置成功了。说实话，用AtomicInteger，常见的是计数，所以说一般是不断累加的，所以ABA问题比较少见
    * 无限循环问题：大家看源码就知道Atomic类设置值的时候会进入一个无限循环，只要不成功，就不停循环再次尝试，这个在高并发修改一个值
的时候其实挺常见的，比如你用AtomicInteger在内存里搞一个原子变量，然后高并发下，多线程频繁修改，其实可能会导致这个compareAndSet()里
要循环N次才设置成功，所以还是要考虑到的。
    * 多变量原子问题：一般的AtomicInteger，只能保证一个变量的原子性，但是如果多个变量呢？你可以用AtomicReference，这个是封装自定
义对象的，多个变量可以放一个自定义对象里，然后他会检查这个对象的引用是不是一个。

```

* ConcurrentHashMap实现线程安全的底层原理到底是什么?

* 你对JDK中的AQS理解吗?AQS的实现原理是什么?

* 说说线程池的底层工作原理可以吗?

* 那你再说说线程池的核心配置参数都是干什么的?平时我们...

* 如果在线程中使用无界阻塞队列会发生什么问题?

* 你知道如果线程池的队列满了之后,会发生什么事情吗?

* 如果线上机器突然宕机,线程池的阻塞队列中的请求怎么...

* 谈谈你对Java内存模型的理解可以吗?

* 你知道Java内存模型中的原子性,有序性,可见性是什么...

* 能聊聊volatile关键字的原理吗?

* 深入讲解volatile关键字的说明[深入到硬件级别]

* 你知道指令重排以及happens-before原则是什么吗?

* volatile底层是如何基于内存屏障保证可见性和有序性的?

* 说说你对Spring的IOC机制的理解可以吗?

* 说说你对Spring的AOP机制的理解可以吗?

* 了解过cglib动态代理吗?他和jdk动态代理的区别什么?

* 能说说Spring中的Bean是线程安全的吗?

* Spring的事务实现原理是什么?能聊聊你对事物传播机制的...

* 能画一张图说说Spring Boot的核心架构吗?

* 能画一张图说说Spring的核心架构吗?

* 能说说Spring中都使用了哪些设计模式吗?

* 能画一张图说说Spring Web MVC的核心架构吗?

* 能画一张图说说Spring Cloud的核心架构吗?

* JVM中有哪几块内存区域?Java8之后对内存做了什么...

* 你知道JVM是如何运行起来的吗?我们的对象是如何分配...

* 说说JVM在哪些情况下会触发垃圾回收可以吗?

* 说说JVM的年轻代垃圾回收算法?对象什么时候转移到老年...

* 说说老年代的垃圾回收算法?常用的垃圾回收器都有什...

* 你们生产环境中的Tomcat是如何设置JVM参数的?如何检查...

* 你在实际项目中是否做过JVM GC优化,怎么做的?

* 你知道发生OOM之后,应该如何排查和处理线上系统的OO...

* 你能聊聊TCP/IP四种网络模型吗?OSI七层网络模型也说一下...

* 浏览器请求www.baidu.com的全过程大概是怎样的?...

* 画一下TCP三次握手流程图?为啥是三次而不是二次或者...

* 聊聊HTTP协议的工作原理!

* 聊聊HTTPS的工作原理?为啥用HTTPS就可以加密通信?

* 聊聊http的长连接的工作原理到底是啥?

* MYSQL,MyISAM和InnoDB存储引擎的区别是啥?

* 聊聊MySQL的索引实现原理?各种索引你们平时都怎么用...

* 你能说说事务的几个特性是啥?有哪几种隔离级别?

* 你能说说MySQL数据库锁的实现原理吗?如果死锁了咋办?

* MySQL的SQL调优一般都有哪些手段?你们一般怎么做?

* 聊聊Socket的工作原理?Socket和TCP IP之间是啥关系?

* 进程之间是如何通信的?线程间又如何切换的?

* 你能聊聊BIO,NIO,AIO分别都是啥?有什么区别?

* 线上服务CPU100%了!该怎么排查,定位和解决?

* 线上机器的一个进程用kill命令杀不死该怎么办?磁盘空间快...

* 关于后续深入硬件级讲解volatile,synchronized,CAS底...

* 再谈原子性: Java规范规定所有变量写操作都是原子的

* 32位Java虚拟机中的long和double变量写操作为何不是原子...

* volatile原来还可以保证long和double变量写操作的原子性

* 到底有哪些操作在Java规范中是不保证原子性的呢?

* 可见性涉及的底层硬件概念: 寄存器,高速缓存,写缓存...

* 深入探秘有序性: Java程序运行过程中发生指令重排的几个...

* JIT编译器对创建对象的指令重排以及double check单例实践

* 现代处理器为了提升性能的指令乱序和猜测执行的机制!

* 高速缓存和写缓存器的内存重排造成的视觉假象

* synchronized锁同时对原子性,可见性，以及有序性的保证

* 深入分析synchronized是如何通过加锁保证原子性的?

* synchronized是如何使用内存屏障保证可见性和有序性的?

* 再看volatile关键字对原子性,可见性以及有序性的保证

* 高速缓存的数据结构: 拉链散列表,缓存条目以及地址解码...

* 结合硬件级别的缓存数据结构深入分析缓存一致性协议...

* 采用写缓冲器和无效队列优化MESI协议的实现性能

* 硬件层面的MESI协议会如何引发有序性和可见性的问题?

* 内存屏障在硬件层面的实现原理以及如何解决各种问题

* 在复杂的硬件模型之上的Java内存模型是如何大幅简化...

* 面试的时候是如何从内存屏障,硬件层面的原理来震慑面试...

* Java虚拟机对锁的优化: 锁消除,锁粗化,偏向锁,自旋锁...

* 再来看看CAS是如何基于MESI协议在底层硬件层面实现...

* 能不能说说一般黑客常用的XSS网络攻击的原理是什么?

* 能不能说说我们经常听到的SQL注入攻击背后的原理是什...

* 听说过CSRF攻击吗?你知道他背后的原理是什么吗?

* 如果你们的系统允许用户上传文件,可能会遭到什么样的黑...

* 让所有工程师闻风色变的DDoS攻击到底是什么东西?

* 基于SYN Flood模式的DDoS攻击,背后的原理是什么呢?

* 再来看看基于DNS Query Flood和HTTP Flood的DDoS攻击

* 在分布式架构中, Zuul网关是如何防止网络攻击的?

* 一个对技术有追求的面试官,是怎么深挖网络与IO的面试...

* Netty的架构原理图能画一下吗,他是如何体现Reactor架...

* 能说说你对堆外内存的理解吗?堆外内存的优势在哪里?

* JDK是如何对堆外内存进行分配和回收的?会发生堆外内存...

* 如何不使用零拷贝技术,普通的IO操作在OS层面是如何执...

* 听说过mmap吗?内存映射技术为什么可以提升IO性能?

* 零拷贝技术到底是什么,他是如何提升IO性能的?

* 你们的分布式系统是如何进行链路监控的?都监控什么?

* 对分布式系统进行核心链路追踪的时候,链路id是怎么管理...

* 聊过两阶段提交了,那么分布式事务三阶段提交的思想能说...

* 唯一id生成机制中的snowflake算法的时钟回拨问题...

* 实现灰度发布的时候,网关是可以灰度了,可是Dubbo服务...

* 除了常见服务注册中心之外,你觉得Redis能作为服务注...

* 我们一般到底用Zookeeper来干什么事儿?

* 有哪些开源的分布式系统中使用了Zookeeper?

* 为什么我们在分布式系统架构中需要使用Zookeeper集群?

* Zookeeper为了满足分布式系统的需求要有哪些特点?

* 为了满足分布式系统的需求,Zookeeper的架构设计有哪...

* Zookeeper集群的三种角色: Leader,Follower,...

* 客户端与Zookeeper之间的长连接和会话是什么?


